% E-Step function in EM algorithm,
% 
function [Q LL] = mog_E_step(X,MOG)

    %Number of components
    L = length(MOG);
    N = length(X(:,1));
    Q = zeros(N, L);
    total = zeros(N, 1);
    for i = 1:L
        prob = MOG{i}.PI * mvnpdf(X, MOG{i}.MU, MOG{i}.SIGMA);
        Q(:,i) = prob;
        total = total + prob;
    end
   
    % probability of 
    Q = Q ./ repmat(total, [1 L]);
   
    LL = sum(log(total));
end
